// ColorBox v1.3.9 - a full featured, light-weight, customizable lightbox based on jQuery 1.3
// c) 2009 Jack Moore - www.colorpowered.com - jack@colorpowered.com
// Additions c) 2010 Katalyst Web Design - katalyst.com.au - haydn@katalyst.com.au
// Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
(function(c,ca){function l(b,d){b=b?' id="'+m+b+'"':"";d=d?' style="'+d+'"':"";return c("<div"+b+d+"/>")}function p(b,d){d=d==="x"?o.width():o.height();return typeof b==="string"?Math.round(b.match(/%/)?d/100*parseInt(b,10):parseInt(b,10)):b}function N(b){b=c.isFunction(b)?b.call(h):b;return a.photo||b.match(/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i)}function Y(){for(var b in a)if(c.isFunction(a[b])&&b.substring(0,2)!=="on")a[b]=a[b].call(h);a.rel=a.rel||h.rel||"nofollow";a.href=a.href||
c(h).attr("href");a.title=a.title||h.title}function Z(b){h=b;a=c.extend({},c(h).data(r));Y();if(a.rel!=="nofollow"){i=c("."+G).filter(function(){return(c(this).data(r).rel||this.rel)===a.rel});g=i.index(h);if(g===-1){i=i.add(h);g=i.length-1}}else{i=c(h);g=0}if(!s){s=D=true;O=h;try{O.blur()}catch(d){}c.event.trigger(da);a.onOpen&&a.onOpen.call(h);u.css({opacity:+a.opacity,cursor:a.overlayClose?"pointer":"auto"}).show();a.w=p(a.initialWidth,"x");a.h=p(a.initialHeight,"y");e.position(0);P&&o.bind("resize."+
L+" scroll."+L,function(){u.css({width:o.width(),height:o.height(),top:o.scrollTop(),left:o.scrollLeft()})}).trigger("scroll."+L)}Q.add(H).add(I).add(v).add(R).hide();S.html(a.close).show();e.slideshow();e.load()}var $={transition:"elastic",speed:300,width:false,initialWidth:"600",innerWidth:false,maxWidth:false,height:false,initialHeight:"450",innerHeight:false,maxHeight:false,scalePhotos:true,scrolling:true,inline:false,html:false,iframe:false,photo:false,href:false,title:false,rel:false,opacity:0.9,
preloading:true,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:false,loop:true,slideshow:false,slideshowAuto:true,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:false,onLoad:false,onComplete:false,onCleanup:false,onClosed:false,overlayClose:true,escKey:true,arrowKey:true},r="colorbox",m="cbox",da=m+"_open",M=m+"_load",T=m+"_complete",U=m+"_cleanup",aa=m+"_closed",E=c.browser.msie&&!c.support.opacity,P=E&&c.browser.version<
7,L=m+"_IE6",u,k,z,q,i,o,n,J,K,R,Q,v,I,H,S,A,B,w,x,h,O,g,a,s,D,e,G=m+"Element";e=c.fn[r]=c[r]=function(b,d){var f=this;if(!f[0]&&f.selector)return f;b=b||{};if(d)b.onComplete=d;if(!f[0]||f.selector===undefined){f=c("<a/>");b.open=true}f.each(function(){c(this).data(r,c.extend({},c(this).data(r)||$,b)).addClass(G)});b.open&&Z(f[0]);return f};e.init=function(){o=c(ca);k=l().attr({id:r,"class":E?m+"IE":""});u=l("Overlay",P?"position:absolute":"").hide();z=l("Wrapper");q=l("Content").append(n=l("LoadedContent",
"width:0; height:0"),K=l("LoadingOverlay").add(l("LoadingGraphic")),R=l("Title"),Q=l("Current"),I=l("Next"),H=l("Previous"),v=l("Slideshow"),S=l("Close"));z.append(q);q.css({"float":"left"});J=l(false,"position:absolute; width:9999px; visibility:hidden; display:none");c("body").prepend(u,k.append(z,J));q.children().hover(function(){c(this).addClass("hover")},function(){c(this).removeClass("hover")}).addClass("hover");A=q.outerHeight(true)-q.height();B=q.outerWidth(true)-q.width();w=n.outerHeight(true);
x=n.outerWidth(true);k.css({"padding-bottom":A,"padding-right":B}).hide();I.click(e.next);H.click(e.prev);S.click(e.close);q.children().removeClass("hover");c("."+G).live("click",function(b){if(b.button!==0&&typeof b.button!=="undefined"||b.ctrlKey||b.shiftKey||b.altKey)return true;else{Z(this);return false}});u.click(function(){a.overlayClose&&e.close()});c(document).bind("keydown",function(b){if(s&&a.escKey&&b.keyCode===27){b.preventDefault();e.close()}if(s&&a.arrowKey&&!D&&i[1])if(b.keyCode===
37&&(g||a.loop)){b.preventDefault();H.click()}else if(b.keyCode===39&&(g<i.length-1||a.loop)){b.preventDefault();I.click()}})};e.remove=function(){k.add(u).remove();c("."+G).die("click").removeData(r).removeClass(G)};e.position=function(b,d){function f(y){q[0].style.width=y.style.width;K[0].style.height=K[1].style.height=q[0].style.height=y.style.height}var j,t=Math.max(o.height()-a.h-w-A,0)/2+o.scrollTop(),C=Math.max(o.width()-a.w-x-B,0)/2+o.scrollLeft();j=k.width()===a.w+x&&k.height()===a.h+w?0:
b;z[0].style.width=z[0].style.height="9999px";k.dequeue().animate({width:a.w+x,height:a.h+w,top:t,left:C},{duration:j,complete:function(){f(this);D=false;z[0].style.width=a.w+x+B+"px";z[0].style.height=a.h+w+A+"px";d&&d()},step:function(){f(this)}})};e.resize=function(b){if(s){b=b||{};if(b.width)a.w=p(b.width,"x")-x-B;if(b.innerWidth)a.w=p(b.innerWidth,"x");n.css({width:a.w});if(b.height)a.h=p(b.height,"y")-w-A;if(b.innerHeight)a.h=p(b.innerHeight,"y");if(!b.innerHeight&&!b.height){b=n.wrapInner("<div style='overflow:auto'></div>").children();
a.h=b.height();b.replaceWith(b.children())}n.css({height:a.h});e.position(a.transition==="none"?0:a.speed)}};e.prep=function(b){function d(t){var C,y,V,W,F=i.length,X=a.loop;e.position(t,function(){function ba(){E&&k[0].style.removeAttribute("filter")}if(s){E&&f&&n.fadeIn(100);if(a.iframe)c("<iframe frameborder=0"+(a.scrolling?"":" scrolling='no'")+(E?" allowtransparency='true'":"")+"/>").attr({src:a.href,name:(new Date).getTime()}).appendTo(n);n.show();R.show().html(a.title);if(F>1){Q.html(a.current.replace(/\{current\}/,
g+1).replace(/\{total\}/,F)).show();I[X||g<F-1?"show":"hide"]().html(a.next);H[X||g?"show":"hide"]().html(a.previous);C=g?i[g-1]:i[F-1];V=g<F-1?i[g+1]:i[0];if(a.slideshow){v.show();g===F-1&&!X&&k.is("."+m+"Slideshow_on")&&v.click()}if(a.preloading){W=c(V).data(r).href||V.href;y=c(C).data(r).href||C.href;if(N(W))c("<img/>")[0].src=W;if(N(y))c("<img/>")[0].src=y}}K.hide();a.transition==="fade"?k.fadeTo(j,1,function(){ba()}):ba();o.bind("resize."+m,function(){e.position(0)});c.event.trigger(T);a.onComplete&&
a.onComplete.call(h)}})}if(s){var f,j=a.transition==="none"?0:a.speed;o.unbind("resize."+m);n.remove();n=l("LoadedContent").html(b);n.hide().appendTo(J.show()).css({width:function(){a.w=a.w||n.width();a.w=a.mw&&a.mw<a.w?a.mw:a.w;return a.w}(),overflow:a.scrolling?"auto":"hidden"}).css({height:function(){a.h=a.h||n.height();a.h=a.mh&&a.mh<a.h?a.mh:a.h;return a.h}()}).prependTo(q);J.hide();c("#"+m+"Photo").css({cssFloat:"none"});P&&c("select").not(k.find("select")).filter(function(){return this.style.visibility!==
"hidden"}).css({visibility:"hidden"}).one(U,function(){this.style.visibility="inherit"});a.transition==="fade"?k.fadeTo(j,0,function(){d(0)}):d(j)}};e.load=function(){var b,d,f,j=e.prep;D=true;h=i[g];a=c.extend({},c(h).data(r));Y();c.event.trigger(M);a.onLoad&&a.onLoad.call(h);a.h=a.height?p(a.height,"y")-w-A:a.innerHeight&&p(a.innerHeight,"y");a.w=a.width?p(a.width,"x")-x-B:a.innerWidth&&p(a.innerWidth,"x");a.mw=a.w;a.mh=a.h;if(a.maxWidth){a.mw=p(a.maxWidth,"x")-x-B;a.mw=a.w&&a.w<a.mw?a.w:a.mw}if(a.maxHeight){a.mh=
p(a.maxHeight,"y")-w-A;a.mh=a.h&&a.h<a.mh?a.h:a.mh}b=a.href;K.show();if(a.inline){l("InlineTemp").hide().insertBefore(c(b)[0]).bind(M+" "+U,function(){c(this).replaceWith(n.children())});j(c(b))}else if(a.iframe)j(" ");else if(a.html)j(a.html);else if(N(b)){d=new Image;d.onload=function(){var t;d.onload=null;d.id=m+"Photo";c(d).css({margin:"auto",border:"none",display:"block",cssFloat:"left"});if(a.scalePhotos){f=function(){d.height-=d.height*t;d.width-=d.width*t};if(a.mw&&d.width>a.mw){t=(d.width-
a.mw)/d.width;f()}if(a.mh&&d.height>a.mh){t=(d.height-a.mh)/d.height;f()}}if(a.h)d.style.marginTop=Math.max(a.h-d.height,0)/2+"px";setTimeout(function(){j(d)},1);if(i[1]&&(g<i.length-1||a.loop))c(d).css({cursor:"pointer"}).click(e.next);if(E)d.style.msInterpolationMode="bicubic"};d.src=b}else l().appendTo(J).load(b,function(t,C,y){j(C==="error"?"Request unsuccessful: "+y.statusText:this)})};e.next=function(){if(!D){g=g<i.length-1?g+1:0;e.load()}};e.prev=function(){if(!D){g=g?g-1:i.length-1;e.load()}};
e.slideshow=function(){function b(){v.text(a.slideshowStop).bind(T,function(){f=setTimeout(e.next,a.slideshowSpeed)}).bind(M,function(){clearTimeout(f)}).one("click",function(){d()});k.removeClass(j+"off").addClass(j+"on")}var d,f,j=m+"Slideshow_";v.bind(aa,function(){v.unbind();clearTimeout(f);k.removeClass(j+"off "+j+"on")});d=function(){clearTimeout(f);v.text(a.slideshowStart).unbind(T+" "+M).one("click",function(){b();f=setTimeout(e.next,a.slideshowSpeed)});k.removeClass(j+"on").addClass(j+"off")};
if(a.slideshow&&i[1])a.slideshowAuto?b():d()};e.close=function(){if(s){s=false;c.event.trigger(U);a.onCleanup&&a.onCleanup.call(h);o.unbind("."+m+" ."+L);u.fadeTo("fast",0);k.stop().fadeTo("fast",0,function(){k.find("iframe").attr("src","about:blank");n.remove();k.add(u).css({opacity:1,cursor:"auto"}).hide();try{O.focus()}catch(b){}setTimeout(function(){c.event.trigger(aa);a.onClosed&&a.onClosed.call(h)},1)})}};e.element=function(){return c(h)};e.settings=$;c(e.init)})(jQuery,this);